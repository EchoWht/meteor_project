{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/templates/posts/post_edit.js","filenameRelative":"/client/templates/posts/post_edit.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/templates/posts/post_edit.js.map","sourceFileName":"/client/templates/posts/post_edit.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"post_edit"},"ignored":false,"code":"Template.postEdit.onCreated(function () {\n    Session.set('postEditErrors', {});\n});\nTemplate.postEdit.helpers({\n    errorMessage: function () {\n        function errorMessage(field) {\n            return Session.get('postEditErrors')[field];\n        }\n\n        return errorMessage;\n    }(),\n    errorClass: function () {\n        function errorClass(field) {\n            return !!Session.get('postEditErrors')[field] ? 'has-error' : '';\n        }\n\n        return errorClass;\n    }()\n});\n\nTemplate.postEdit.events({\n    'submit form': function () {\n        function submitForm(e) {\n            e.preventDefault();\n\n            var currentPostId = this._id;\n\n            var postProperties = {\n                url: $(e.target).find('[name=url]').val(),\n                title: $(e.target).find('[name=title]').val()\n            };\n\n            var errors = validatePost(postProperties);\n            if (errors.title || errors.url) return Session.set('postEditErrors', errors);\n\n            Posts.update(currentPostId, { $set: postProperties }, function (error) {\n                if (error) {\n                    // 向用户显示错误消息\n                    throwError(error.reason);\n                } else {\n                    Router.go('postPage', { _id: currentPostId });\n                }\n            });\n        }\n\n        return submitForm;\n    }(),\n\n    'click .delete': function () {\n        function clickDelete(e) {\n            e.preventDefault();\n\n            if (confirm(\"Delete this post?\")) {\n                var currentPostId = this._id;\n                Posts.remove(currentPostId);\n                Router.go('home');\n            }\n        }\n\n        return clickDelete;\n    }()\n});","ast":null,"map":{"version":3,"sources":["/client/templates/posts/post_edit.js"],"names":[],"mappings":"AAAA,SAAS,QAAT,CAAkB,SAAlB,CAA4B,YAAW;AACnC,YAAQ,GAAR,CAAY,gBAAZ,EAA8B,EAA9B,EADmC;CAAX,CAA5B;AAGA,SAAS,QAAT,CAAkB,OAAlB,CAA0B;AACtB;AAAc,8BAAS,KAAT,EAAgB;AAC1B,mBAAO,QAAQ,GAAR,CAAY,gBAAZ,EAA8B,KAA9B,CAAP,CAD0B;SAAhB;;;OAAd;AAGA;AAAY,4BAAU,KAAV,EAAiB;AACzB,mBAAO,CAAC,CAAC,QAAQ,GAAR,CAAY,gBAAZ,EAA8B,KAA9B,CAAD,GAAwC,WAAzC,GAAuD,EAAvD,CADkB;SAAjB;;;OAAZ;CAJJ;;AASA,SAAS,QAAT,CAAkB,MAAlB,CAAyB;AACrB;AAAe,4BAAS,CAAT,EAAY;AACvB,cAAE,cAAF,GADuB;;AAGvB,gBAAI,gBAAgB,KAAK,GAAL,CAHG;;AAKvB,gBAAI,iBAAiB;AACjB,qBAAK,EAAE,EAAE,MAAF,CAAF,CAAY,IAAZ,CAAiB,YAAjB,EAA+B,GAA/B,EAAL;AACA,uBAAO,EAAE,EAAE,MAAF,CAAF,CAAY,IAAZ,CAAiB,cAAjB,EAAiC,GAAjC,EAAP;aAFA,CALmB;;AAUvB,gBAAI,SAAS,aAAa,cAAb,CAAT,CAVmB;AAWvB,gBAAI,OAAO,KAAP,IAAgB,OAAO,GAAP,EAChB,OAAO,QAAQ,GAAR,CAAY,gBAAZ,EAA8B,MAA9B,CAAP,CADJ;;AAGA,kBAAM,MAAN,CAAa,aAAb,EAA4B,EAAC,MAAM,cAAN,EAA7B,EAAoD,UAAS,KAAT,EAAgB;AAChE,oBAAI,KAAJ,EAAW;;AAEP,+BAAW,MAAM,MAAN,CAAX,CAFO;iBAAX,MAGO;AACH,2BAAO,EAAP,CAAU,UAAV,EAAsB,EAAC,KAAK,aAAL,EAAvB,EADG;iBAHP;aADgD,CAApD,CAduB;SAAZ;;;OAAf;;AAwBA;AAAiB,6BAAS,CAAT,EAAY;AACzB,cAAE,cAAF,GADyB;;AAGzB,gBAAI,QAAQ,mBAAR,CAAJ,EAAkC;AAC9B,oBAAI,gBAAgB,KAAK,GAAL,CADU;AAE9B,sBAAM,MAAN,CAAa,aAAb,EAF8B;AAG9B,uBAAO,EAAP,CAAU,MAAV,EAH8B;aAAlC;SAHa;;;OAAjB;CAzBJ","file":"/client/templates/posts/post_edit.js.map","sourcesContent":["Template.postEdit.onCreated(function() {\r\n    Session.set('postEditErrors', {});\r\n});\r\nTemplate.postEdit.helpers({\r\n    errorMessage: function(field) {\r\n        return Session.get('postEditErrors')[field];\r\n    },\r\n    errorClass: function (field) {\r\n        return !!Session.get('postEditErrors')[field] ? 'has-error' : '';\r\n    }\r\n});\r\n\r\nTemplate.postEdit.events({\r\n    'submit form': function(e) {\r\n        e.preventDefault();\r\n\r\n        var currentPostId = this._id;\r\n\r\n        var postProperties = {\r\n            url: $(e.target).find('[name=url]').val(),\r\n            title: $(e.target).find('[name=title]').val()\r\n        }\r\n\r\n        var errors = validatePost(postProperties);\r\n        if (errors.title || errors.url)\r\n            return Session.set('postEditErrors', errors);\r\n\r\n        Posts.update(currentPostId, {$set: postProperties}, function(error) {\r\n            if (error) {\r\n                // 向用户显示错误消息\r\n                throwError(error.reason);\r\n            } else {\r\n                Router.go('postPage', {_id: currentPostId});\r\n            }\r\n        });\r\n    },\r\n\r\n    'click .delete': function(e) {\r\n        e.preventDefault();\r\n\r\n        if (confirm(\"Delete this post?\")) {\r\n            var currentPostId = this._id;\r\n            Posts.remove(currentPostId);\r\n            Router.go('home');\r\n        }\r\n    }\r\n});"]},"hash":"85030d66ecee54fdefa3e4e1ddd571ef837c1033"}
