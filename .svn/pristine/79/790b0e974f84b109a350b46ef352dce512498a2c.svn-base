{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/templates/posts/post_submit.js","filenameRelative":"/client/templates/posts/post_submit.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/templates/posts/post_submit.js.map","sourceFileName":"/client/templates/posts/post_submit.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"post_submit"},"ignored":false,"code":"/**\r\n * Created by Administrator on 2016-06-10.\r\n */\nTemplate.postSubmit.onCreated(function () {\n    Session.set('postSubmitErrors', {});\n});\nTemplate.postSubmit.helpers({\n    errorMessage: function () {\n        function errorMessage(field) {\n            return Session.get('postSubmitErrors')[field];\n        }\n\n        return errorMessage;\n    }(),\n    errorClass: function () {\n        function errorClass(field) {\n            return !!Session.get('postSubmitErrors')[field] ? 'has-error' : '';\n        }\n\n        return errorClass;\n    }()\n});\nTemplate.postSubmit.events({\n    'submit form': function () {\n        function submitForm(e) {\n            e.preventDefault();\n\n            var post = {\n                url: $(e.target).find('[name=url]').val(),\n                title: $(e.target).find('[name=title]').val()\n            };\n            var errors = validatePost(post);\n            if (errors.title || errors.url) return Session.set('postSubmitErrors', errors);\n            Meteor.call('postInsert', post, function (error, result) {\n                // 显示错误信息并退出\n                if (error) return throwError(error.reason);\n                // 显示结果，跳转页面\n                if (result.postExists) return throwError('链接已存在');;\n                Router.go('postPage', { _id: result._id });\n            });\n        }\n\n        return submitForm;\n    }()\n});","ast":null,"map":{"version":3,"sources":["/client/templates/posts/post_submit.js"],"names":[],"mappings":";;;AAGA,SAAS,UAAT,CAAoB,SAApB,CAA8B,YAAW;AACrC,YAAQ,GAAR,CAAY,kBAAZ,EAAgC,EAAhC,EADqC;CAAX,CAA9B;AAGA,SAAS,UAAT,CAAoB,OAApB,CAA4B;AACxB;AAAc,8BAAS,KAAT,EAAgB;AAC1B,mBAAO,QAAQ,GAAR,CAAY,kBAAZ,EAAgC,KAAhC,CAAP,CAD0B;SAAhB;;;OAAd;AAGA;AAAY,4BAAU,KAAV,EAAiB;AACzB,mBAAO,CAAC,CAAC,QAAQ,GAAR,CAAY,kBAAZ,EAAgC,KAAhC,CAAD,GAA0C,WAA3C,GAAyD,EAAzD,CADkB;SAAjB;;;OAAZ;CAJJ;AAQA,SAAS,UAAT,CAAoB,MAApB,CAA2B;AACvB;AAAe,4BAAS,CAAT,EAAY;AACvB,cAAE,cAAF,GADuB;;AAGvB,gBAAI,OAAO;AACP,qBAAK,EAAE,EAAE,MAAF,CAAF,CAAY,IAAZ,CAAiB,YAAjB,EAA+B,GAA/B,EAAL;AACA,uBAAO,EAAE,EAAE,MAAF,CAAF,CAAY,IAAZ,CAAiB,cAAjB,EAAiC,GAAjC,EAAP;aAFA,CAHmB;AAOvB,gBAAI,SAAS,aAAa,IAAb,CAAT,CAPmB;AAQvB,gBAAI,OAAO,KAAP,IAAgB,OAAO,GAAP,EAChB,OAAO,QAAQ,GAAR,CAAY,kBAAZ,EAAgC,MAAhC,CAAP,CADJ;AAEA,mBAAO,IAAP,CAAY,YAAZ,EAA0B,IAA1B,EAAgC,UAAS,KAAT,EAAgB,MAAhB,EAAwB;;AAEpD,oBAAI,KAAJ,EACI,OAAO,WAAW,MAAM,MAAN,CAAlB,CADJ;;AAFoD,oBAKhD,OAAO,UAAP,EACA,OAAO,WAAW,OAAX,CAAP,CADJ,CALoD;AAOpD,uBAAO,EAAP,CAAU,UAAV,EAAsB,EAAC,KAAK,OAAO,GAAP,EAA5B,EAPoD;aAAxB,CAAhC,CAVuB;SAAZ;;;OAAf;CADJ","file":"/client/templates/posts/post_submit.js.map","sourcesContent":["/**\r\n * Created by Administrator on 2016-06-10.\r\n */\r\nTemplate.postSubmit.onCreated(function() {\r\n    Session.set('postSubmitErrors', {});\r\n});\r\nTemplate.postSubmit.helpers({\r\n    errorMessage: function(field) {\r\n        return Session.get('postSubmitErrors')[field];\r\n    },\r\n    errorClass: function (field) {\r\n        return !!Session.get('postSubmitErrors')[field] ? 'has-error' : '';\r\n    }\r\n});\r\nTemplate.postSubmit.events({\r\n    'submit form': function(e) {\r\n        e.preventDefault();\r\n\r\n        var post = {\r\n            url: $(e.target).find('[name=url]').val(),\r\n            title: $(e.target).find('[name=title]').val()\r\n        };\r\n        var errors = validatePost(post);\r\n        if (errors.title || errors.url)\r\n            return Session.set('postSubmitErrors', errors);\r\n        Meteor.call('postInsert', post, function(error, result) {\r\n            // 显示错误信息并退出\r\n            if (error)\r\n                return throwError(error.reason);\r\n            // 显示结果，跳转页面\r\n            if (result.postExists)\r\n                return throwError('链接已存在');;\r\n            Router.go('postPage', {_id: result._id});\r\n        });\r\n    }\r\n});"]},"hash":"a9bfe1b7d2875ca409924ecc1fda51b526dcc0b6"}
