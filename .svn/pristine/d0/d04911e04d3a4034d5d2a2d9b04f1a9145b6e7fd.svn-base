var require = meteorInstall({"lib":{"router.js":function(){

//////////////////////////////////////////////////////////////////////////
//                                                                      //
// lib/router.js                                                        //
//                                                                      //
//////////////////////////////////////////////////////////////////////////
                                                                        //
Router.configure({                                                      // 1
  layoutTemplate: 'layout',                                             // 2
  loadingTemplate: 'loading',                                           // 3
  notFoundTemplate: 'notFound',                                         // 4
  waitOn: function () {                                                 // 5
    function waitOn() {                                                 // 5
      return Meteor.subscribe('posts');                                 // 5
    }                                                                   //
                                                                        //
    return waitOn;                                                      //
  }()                                                                   //
});                                                                     //
                                                                        //
Router.route('/', { name: 'postsList' });                               // 8
Router.route('/posts/:_id', {                                           // 9
  name: 'postPage',                                                     // 10
  data: function () {                                                   // 11
    function data() {                                                   // 11
      return Posts.findOne(this.params._id);                            // 12
    }                                                                   //
                                                                        //
    return data;                                                        //
  }()                                                                   //
});                                                                     //
Router.route('/submit', { name: 'postSubmit' });                        // 14
                                                                        //
var requireLogin = function requireLogin() {                            // 16
  if (!Meteor.user()) {                                                 // 17
    this.render('accessDenied');                                        // 18
    if (Meteor.loggingIn()) {                                           // 19
      this.render(this.loadingTemplate);                                // 20
    } else {                                                            //
      this.render('accessDenied');                                      // 22
    }                                                                   //
  } else {                                                              //
    this.next();                                                        // 25
  }                                                                     //
};                                                                      //
// 如果有人输入了像 http://localhost:3000/posts/xyz 这种格式的 URL，xyz 不是一个合法的帖子 _id
Router.onBeforeAction('dataNotFound', { only: 'postPage' });            // 29
Router.onBeforeAction(requireLogin, { only: 'postSubmit' });            // 30
//////////////////////////////////////////////////////////////////////////

}},"collections":{"posts.js":function(){

//////////////////////////////////////////////////////////////////////////
//                                                                      //
// collections/posts.js                                                 //
//                                                                      //
//////////////////////////////////////////////////////////////////////////
                                                                        //
Posts = new Mongo.Collection('posts');                                  // 1
Meteor.methods({                                                        // 2
    postInsert: function () {                                           // 3
        function postInsert(postAttributes) {                           // 3
            check(Meteor.userId(), String);                             // 4
            check(postAttributes, {                                     // 5
                title: String,                                          // 6
                url: String                                             // 7
            });                                                         //
            var user = Meteor.user();                                   // 9
            var post = _.extend(postAttributes, {                       // 10
                userId: user._id,                                       // 11
                author: user.username,                                  // 12
                submitted: new Date()                                   // 13
            });                                                         //
            var postId = Posts.insert(post);                            // 15
            return {                                                    // 16
                _id: postId                                             // 17
            };                                                          //
        }                                                               //
                                                                        //
        return postInsert;                                              //
    }()                                                                 //
});                                                                     //
//////////////////////////////////////////////////////////////////////////

}},"server":{"fixtures.js":function(){

//////////////////////////////////////////////////////////////////////////
//                                                                      //
// server/fixtures.js                                                   //
//                                                                      //
//////////////////////////////////////////////////////////////////////////
                                                                        //
if (Posts.find().count() === 0) {                                       // 1
  Posts.insert({                                                        // 2
    title: 'Introducing Telescope',                                     // 3
    url: 'http://sachagreif.com/introducing-telescope/'                 // 4
  });                                                                   //
                                                                        //
  Posts.insert({                                                        // 7
    title: 'Meteor',                                                    // 8
    url: 'http://meteor.com'                                            // 9
  });                                                                   //
                                                                        //
  Posts.insert({                                                        // 12
    title: 'The Meteor Book',                                           // 13
    url: 'http://themeteorbook.com'                                     // 14
  });                                                                   //
}                                                                       //
//////////////////////////////////////////////////////////////////////////

},"publications.js":function(){

//////////////////////////////////////////////////////////////////////////
//                                                                      //
// server/publications.js                                               //
//                                                                      //
//////////////////////////////////////////////////////////////////////////
                                                                        //
Meteor.publish('posts', function () {                                   // 1
  return Posts.find({ flagged: false });                                // 2
});                                                                     //
//////////////////////////////////////////////////////////////////////////

},"main.js":["meteor/meteor",function(require){

//////////////////////////////////////////////////////////////////////////
//                                                                      //
// server/main.js                                                       //
//                                                                      //
//////////////////////////////////////////////////////////////////////////
                                                                        //
var _meteor = require('meteor/meteor');                                 // 1
                                                                        //
//Meteor.subscribe('posts');                                            //
_meteor.Meteor.startup(function () {                                    // 3
  // code to run on server at startup                                   //
});                                                                     //
//////////////////////////////////////////////////////////////////////////

}]}},{"extensions":[".js",".json"]});
require("./lib/router.js");
require("./collections/posts.js");
require("./server/fixtures.js");
require("./server/publications.js");
require("./server/main.js");
//# sourceMappingURL=app.js.map
